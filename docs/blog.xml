<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>EpiStats</title>
<link>https://CarlosEpiStats.github.io/blog/blog.html</link>
<atom:link href="https://CarlosEpiStats.github.io/blog/blog.xml" rel="self" type="application/rss+xml"/>
<description>A blog about Epidemiology and Biostatistics by Carlos Fernández, MD MPH.</description>
<generator>quarto-1.3.353</generator>
<lastBuildDate>Fri, 24 May 2024 22:00:00 GMT</lastBuildDate>
<item>
  <title>Useful RStudio Shortcuts</title>
  <dc:creator>Carlos Fernández</dc:creator>
  <link>https://CarlosEpiStats.github.io/blog/posts/tips_and_tricks_r4ds/post.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>I recently bought the acclaimed book <em>R for Data Science”</em>(2nd ed.) by Hadley Wichkam et al., and I’ve been finding interesting tidbits that I’d like to share. Most of them are quality-of-life tools that I wasn’t aware of, while others are simply cool tricks.</p>
<p>Note: These shortcuts works for RStudio on Windows. On macOS, replace “Ctrl” with “Cmd”.</p>
</section>
<section id="useful-shortcuts" class="level1">
<h1>Useful shortcuts</h1>
<p>The thing with shortcuts is that they don’t really stick to me when I’m starting to learn a new programming language, software tool, or whatever. It’s after I’ve spent hundreds of hours working with them that I stumble upon a small, innocuous shortcut that suddenly makes my life brighter and much easier. Today, I share a few that I’ve encountered in the first chapters of <em>R for Data Science</em> (R4DS for short).</p>
<p>Let’s illustrate them with an example code. I will use the sample datasets that come with the package <code>medicaldata</code>. Specifically, I’ll toy with the dataset called <code>strep_tb</code>, which represent a classic Randomized Controlled Trial on the effects of streptomycin to treat tuberculosis (in fact, it is considered the first modern randomized, placebo-controlled clinical trial).</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(medicaldata)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-4"></span>
<span id="cb1-5">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> medicaldata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>strep_tb</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 107
Columns: 13
$ patient_id          &lt;chr&gt; "0001", "0002", "0003", "0004", "0005", "0006", "0…
$ arm                 &lt;fct&gt; Control, Control, Control, Control, Control, Contr…
$ dose_strep_g        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ dose_PAS_g          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ gender              &lt;fct&gt; M, F, F, M, F, M, F, M, F, M, F, M, F, M, F, M, F,…
$ baseline_condition  &lt;fct&gt; 1_Good, 1_Good, 1_Good, 1_Good, 1_Good, 1_Good, 1_…
$ baseline_temp       &lt;fct&gt; 1_98-98.9F, 3_100-100.9F, 1_98-98.9F, 1_98-98.9F, …
$ baseline_esr        &lt;fct&gt; 2_11-20, 2_11-20, 3_21-50, 3_21-50, 3_21-50, 3_21-…
$ baseline_cavitation &lt;fct&gt; yes, no, no, no, no, no, yes, yes, yes, yes, no, y…
$ strep_resistance    &lt;fct&gt; 1_sens_0-8, 1_sens_0-8, 1_sens_0-8, 1_sens_0-8, 1_…
$ radiologic_6m       &lt;fct&gt; 6_Considerable_improvement, 5_Moderate_improvement…
$ rad_num             &lt;dbl&gt; 6, 5, 5, 5, 5, 6, 5, 5, 5, 5, 6, 5, 5, 5, 5, 6, 5,…
$ improved            &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TR…</code></pre>
</div>
</div>
<section id="alt----" class="level2">
<h2 class="anchored" data-anchor-id="alt----"><code>Alt</code> + <code>-</code> : <code>&lt;-</code></h2>
<p>Here I’ve used the first of the shortcuts, believe it or not: <code>Alt</code> + <code>-</code> to create the assignment arrow <code>&lt;-</code>. Instead of having to type ““, then”<code>&lt;</code>“, then”<code>-</code>“, then”” (4 keys in total), now just with <code>Alt</code> + <code>-</code> (2 keys simultaneously) I can get the job done, because spacing is added automatically. A silly little trick, but very useful, especially when I’m working with a keyboard that doesn’t have the <code>&lt;</code> or <code>&gt;</code> keys in the same place as others.</p>
</section>
<section id="ctrl-up-list-all-similar-commands-in-the-consoles-history" class="level2">
<h2 class="anchored" data-anchor-id="ctrl-up-list-all-similar-commands-in-the-consoles-history"><code>Ctrl</code> + <code>Up</code> : List All Similar Commands in the Console’s History</h2>
<p>This I can’t show you with code, but with a screenshot of RStudio’s console. If you press <code>Ctrl</code> + <code>Up arrow</code>, you can see a list of previous commands that start with the same words. You can access commands that were typed even in previous R sessions working with different files. I find it useful to trace back to some command that I want to replicate.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/tips_and_tricks_r4ds/screenshot_01.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><code>Ctrl</code> + <code>Up</code> lets you look at your Console’s history of similar commands.</figcaption>
</figure>
</div>
</section>
<section id="f1-when-the-autocomplete-yellow-box-pops-up-access-the-help-file-of-that-function" class="level2">
<h2 class="anchored" data-anchor-id="f1-when-the-autocomplete-yellow-box-pops-up-access-the-help-file-of-that-function">F1 When the Autocomplete Yellow Box Pops Up : Access the Help File of That Function</h2>
<p>How many times have I tried to remember the specific syntax of a function and had to go back and forth between the actual code and typing <code>help()</code> or <code>?function</code> ? There was an easier way: just press <code>F1</code> When the little yellow box of autocomplete appears while typing the function. It makes the R Documentation file appear in the RStudio help panel, and I can look into it without even needing to stop from coding.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/tips_and_tricks_r4ds/screenshot_02.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><code>F1</code> when the autocomplete yellow box pops up…</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/tips_and_tricks_r4ds/screenshot_03.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">…the R Documentation help file appears right away in RStudio.</figcaption>
</figure>
</div>
</section>
<section id="ctrl-shift-r-create-sections-in-your-code" class="level2">
<h2 class="anchored" data-anchor-id="ctrl-shift-r-create-sections-in-your-code"><code>Ctrl</code> + <code>Shift</code> + <code>R</code>: Create Sections in Your Code</h2>
<p>One way to organize your R code more neatly is to use sections and sub-sections. To create a section, start with a comment (<code>#</code> followed by text), and end with a sequence of four or more hyphens or hashtags (<code>----</code> or <code>####</code>). That will tell RStudio that that particular line of text is a section, and you can jump between sections using the R editor window.</p>
<p>The shortcut <code>Ctrl</code> + <code>Shift</code> + <code>R</code> pops up a window for you to enter the label of the section, and a new section appears, saving you the trouble of typing all those hyphens manually.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/tips_and_tricks_r4ds/screenshot_04.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><code>Ctrl</code> + <code>Shift</code> + <code>R</code> makes creating sections easy and fast.</figcaption>
</figure>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is a section -------------------------------------------------------</span></span></code></pre></div>
</details>
</div>
</section>
<section id="other-shortcuts" class="level2">
<h2 class="anchored" data-anchor-id="other-shortcuts">Other Shortcuts</h2>
<p>Lastly, I’ll share some other useful shortcuts:</p>
<ul>
<li><p><code>Ctrl</code> + <code>Shift</code> + <code>P</code>: Open the “command palette” of RStudio, useful to find every command the IDE and its add-ins (like the “styler” package) have to offer, including their own shortcuts.</p></li>
<li><p><code>Ctrl</code> + <code>Shift</code> + <code>S</code>: Runs the whole script.</p></li>
<li><p><code>Ctrl</code> + <code>Shift</code> + <code>F10</code>: Restart the R session.</p></li>
</ul>
<p>That’s all for now. See you next time!</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><a href="https://r4ds.hadley.nz/"><em>R for Data Science</em> (2nd ed)</a></li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>ggplot</category>
  <category>tidyverse</category>
  <guid>https://CarlosEpiStats.github.io/blog/posts/tips_and_tricks_r4ds/post.html</guid>
  <pubDate>Fri, 24 May 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>COVID-19 Outbreak Report: An Example Using R</title>
  <dc:creator>Carlos Fernández</dc:creator>
  <link>https://CarlosEpiStats.github.io/blog/posts/outbreak_report/post.html</link>
  <description><![CDATA[ 



<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install the latest version of the Epi R Handbook package</span></span>
<span id="cb1-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_install_gh</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"appliedepi/epirhandbook"</span>)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load the package for use</span></span>
<span id="cb1-4">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(rio, </span>
<span id="cb1-5">               tidyverse, </span>
<span id="cb1-6">               here, </span>
<span id="cb1-7">               epirhandbook, </span>
<span id="cb1-8">               openxlsx, </span>
<span id="cb1-9">               janitor, </span>
<span id="cb1-10">               skimr,</span>
<span id="cb1-11">               epikit)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculating age from two dates</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">calculate_age <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(from, to) {</span>
<span id="cb2-4">  </span>
<span id="cb2-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert dates to POSIXlt format</span></span>
<span id="cb2-6">  from_lt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXlt</span>(from)</span>
<span id="cb2-7">  to_lt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXlt</span>(to)</span>
<span id="cb2-8">  </span>
<span id="cb2-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get number of years of difference</span></span>
<span id="cb2-10">  age <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> to_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> from_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>year</span>
<span id="cb2-11">  </span>
<span id="cb2-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if day and month in "to" date is later than in "from" date</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(to_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> from_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb2-14">           (to_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> from_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mon <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> to_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mday <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> from_lt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mday),</span>
<span id="cb2-15">         age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, age)</span>
<span id="cb2-16">}</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download file ####</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">file_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/appliedepi/epiRhandbook_eng/master/data/covid_example_data/covid_example_data.xlsx"</span></span>
<span id="cb3-4">destination <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outbreak_report"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outbreak_data.xlsx"</span>)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(file_url, destination, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb"</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load and clean file ####</span></span>
<span id="cb3-9"></span>
<span id="cb3-10">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outbreak_report"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outbreak_data.xlsx"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-11">  </span>
<span id="cb3-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Standardize variable names</span></span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>                     </span>
<span id="cb3-14">  </span>
<span id="cb3-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove ending "_false" in variable names</span></span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_false"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, .x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-17">  </span>
<span id="cb3-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># De-duplicate</span></span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  (0 duplicated rows)                   </span></span>
<span id="cb3-20">  </span>
<span id="cb3-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-22">   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all "Unk" and "Unknown" in character variables to NA </span></span>
<span id="cb3-23">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.character) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pid,</span>
<span id="cb3-24">           <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-25">             .x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unk"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unknown"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unknown symptom status"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UNKNOWN"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NOT SPECIFIED"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Under Review"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pending"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb3-26">             <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .x)</span>
<span id="cb3-27">           ),                                                </span>
<span id="cb3-28">    </span>
<span id="cb3-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simplify options for some variables</span></span>
<span id="cb3-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sym_resolved =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-31">      sym_resolved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yes, date specified below"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yes, date unknown"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yes"</span>,  </span>
<span id="cb3-32">      sym_resolved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No, still symptomatic"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No"</span>),</span>
<span id="cb3-33">    </span>
<span id="cb3-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">contact_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-35">      contact_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yes-Symptomatic"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yes"</span>, </span>
<span id="cb3-36">      contact_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No-Asymptomatic"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No"</span>),</span>
<span id="cb3-37">    </span>
<span id="cb3-38">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace "YES" for "Yes"</span></span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sym_myalgia =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-40">      sym_myalgia <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YES"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yes"</span>,</span>
<span id="cb3-41">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sym_myalgia),  </span>
<span id="cb3-42">    </span>
<span id="cb3-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all character variables (except pid) into factors</span></span>
<span id="cb3-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.character) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pid,</span>
<span id="cb3-45">           <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(.x)),  </span>
<span id="cb3-46">    </span>
<span id="cb3-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Standardize answer order in all yes-no variables: first "Yes", then "No"</span></span>
<span id="cb3-48">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.factor) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(case_gender, case_race, case_eth, covid_dx),</span>
<span id="cb3-49">           <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No"</span>))),</span>
<span id="cb3-50"></span>
<span id="cb3-51">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean dates</span></span>
<span id="cb3-52">    </span>
<span id="cb3-53">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Some dates of birth are later than the dates of report creation, which is impossible</span></span>
<span id="cb3-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case_dob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(case_dob <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> reprt_creationdt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb3-55">                         <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> case_dob),</span>
<span id="cb3-56">    </span>
<span id="cb3-57">    </span>
<span id="cb3-58">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Recalculate ages with custom function which is more accurate</span></span>
<span id="cb3-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_recalc =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_age</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> case_dob, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> reprt_creationdt)</span>
<span id="cb3-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Create age groups</span></span>
<span id="cb3-61">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># age_cat = age_categories()</span></span>
<span id="cb3-62"></span>
<span id="cb3-63">    </span>
<span id="cb3-64">    </span>
<span id="cb3-65">        )</span>
<span id="cb3-66"></span>
<span id="cb3-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To-Do</span></span>
<span id="cb3-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean symptoms start and end dates, report date, hospital_admision date, hospital discharche,</span></span>
<span id="cb3-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># death date</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 82,101
Columns: 32
$ pid                &lt;chr&gt; "3a85e6992a5ac52f", "c6b5281d5fc50b96", "53495ad0dc…
$ reprt_creationdt   &lt;dttm&gt; 2020-03-22, 2020-02-01, 2020-02-10, 2020-03-20, 20…
$ case_dob           &lt;dttm&gt; 2004-11-08, 1964-06-07, 1944-04-06, 1964-06-25, 19…
$ case_age           &lt;dbl&gt; 16, 57, 77, 57, 56, 65, 47, 61, 36, 42, 74, 27, 80,…
$ case_gender        &lt;fct&gt; Male, Male, Female, Female, Male, Male, Male, Femal…
$ case_race          &lt;fct&gt; WHITE, WHITE, BLACK, BLACK, WHITE, BLACK, BLACK, BL…
$ case_eth           &lt;fct&gt; NON-HISPANIC/LATINO, NON-HISPANIC/LATINO, NON-HISPA…
$ case_zip           &lt;dbl&gt; 30308, 30308, 30315, 30213, 30004, 30314, 30313, 30…
$ contact_id         &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Y…
$ sym_startdt        &lt;dttm&gt; 2020-03-20, 2020-01-28, 2020-02-10, 2021-05-19, 20…
$ sym_fever          &lt;fct&gt; Yes, No, Yes, No, Yes, Yes, No, Yes, No, Yes, NA, N…
$ sym_subjfever      &lt;fct&gt; Yes, No, NA, Yes, Yes, Yes, No, Yes, Yes, No, NA, Y…
$ sym_myalgia        &lt;fct&gt; No, Yes, Yes, Yes, Yes, No, NA, No, No, Yes, NA, No…
$ sym_losstastesmell &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, Yes, NA, NA, NA…
$ sym_sorethroat     &lt;fct&gt; Yes, No, Yes, Yes, No, NA, Yes, Yes, Yes, Yes, NA, …
$ sym_cough          &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Y…
$ sym_headache       &lt;fct&gt; Yes, No, NA, Yes, No, NA, Yes, No, Yes, No, NA, No,…
$ sym_resolved       &lt;fct&gt; No, No, No, No, No, Yes, No, No, No, No, No, No, Ye…
$ sym_resolveddt     &lt;dttm&gt; NA, NA, NA, NA, NA, 2020-02-21, NA, NA, NA, NA, NA…
$ contact_household  &lt;fct&gt; Yes, No, NA, No, No, No, No, No, No, Yes, No, No, Y…
$ hospitalized       &lt;fct&gt; No, No, Yes, NA, Yes, Yes, Yes, No, No, Yes, NA, No…
$ hosp_admidt        &lt;dttm&gt; NA, NA, 2020-02-08, NA, 2020-02-26, 2020-01-27, 20…
$ hosp_dischdt       &lt;dttm&gt; NA, NA, NA, NA, NA, 2020-02-21, NA, NA, NA, 2020-1…
$ died               &lt;fct&gt; No, No, No, No, NA, Yes, No, NA, No, No, NA, No, Ye…
$ died_covid         &lt;fct&gt; No, No, No, No, NA, Yes, No, NA, No, No, NA, No, Ye…
$ died_dt            &lt;dttm&gt; NA, NA, NA, NA, NA, 2020-02-21, NA, NA, NA, NA, NA…
$ confirmed_case     &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Yes, Y…
$ covid_dx           &lt;fct&gt; Confirmed, Confirmed, Confirmed, Confirmed, Confirm…
$ pos_sampledt       &lt;dttm&gt; 2020-03-22, 2020-02-01, 2020-02-10, 2021-01-17, 20…
$ latitude_jitt      &lt;dbl&gt; 33.776645460, 33.780510140, 33.730233310, 33.555067…
$ longitude_jitt     &lt;dbl&gt; -84.385685230, -84.389474740, -84.384251890, -84.62…
$ age_recalc         &lt;dbl&gt; 15, 55, 75, 55, 55, 63, 45, 60, 34, 41, 73, 26, 78,…</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skim</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">Piped data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">82101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POSIXct</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pid</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">82087</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">case_gender</td>
<td style="text-align: right;">409</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Fem: 43299, Mal: 38393</td>
</tr>
<tr class="even">
<td style="text-align: left;">case_race</td>
<td style="text-align: right;">6353</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">BLA: 35048, WHI: 31599, OTH: 5863, ASI: 3075</td>
</tr>
<tr class="odd">
<td style="text-align: left;">case_eth</td>
<td style="text-align: right;">10799</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NON: 62677, HIS: 8625</td>
</tr>
<tr class="even">
<td style="text-align: left;">contact_id</td>
<td style="text-align: right;">33298</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Yes: 41282, No: 7521</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sym_fever</td>
<td style="text-align: right;">33023</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 33951, Yes: 15127</td>
</tr>
<tr class="even">
<td style="text-align: left;">sym_subjfever</td>
<td style="text-align: right;">38932</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 30457, Yes: 12712</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sym_myalgia</td>
<td style="text-align: right;">33357</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 29210, Yes: 19534</td>
</tr>
<tr class="even">
<td style="text-align: left;">sym_losstastesmell</td>
<td style="text-align: right;">51258</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 18109, Yes: 12734</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sym_sorethroat</td>
<td style="text-align: right;">33479</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 36106, Yes: 12516</td>
</tr>
<tr class="even">
<td style="text-align: left;">sym_cough</td>
<td style="text-align: right;">32684</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 27474, Yes: 21943</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sym_headache</td>
<td style="text-align: right;">33230</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 27196, Yes: 21675</td>
</tr>
<tr class="even">
<td style="text-align: left;">sym_resolved</td>
<td style="text-align: right;">44370</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Yes: 23265, No: 14466</td>
</tr>
<tr class="odd">
<td style="text-align: left;">contact_household</td>
<td style="text-align: right;">42003</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 28500, Yes: 11598</td>
</tr>
<tr class="even">
<td style="text-align: left;">hospitalized</td>
<td style="text-align: right;">32482</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 44322, Yes: 5297</td>
</tr>
<tr class="odd">
<td style="text-align: left;">died</td>
<td style="text-align: right;">36990</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 43407, Yes: 1704</td>
</tr>
<tr class="even">
<td style="text-align: left;">died_covid</td>
<td style="text-align: right;">42425</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">No: 38338, Yes: 1338</td>
</tr>
<tr class="odd">
<td style="text-align: left;">confirmed_case</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Yes: 82062, No: 26</td>
</tr>
<tr class="even">
<td style="text-align: left;">covid_dx</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Con: 82101</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">case_age</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">39.69</td>
<td style="text-align: right;">19.16</td>
<td style="text-align: right;">-20.0</td>
<td style="text-align: right;">25.00</td>
<td style="text-align: right;">37.00</td>
<td style="text-align: right;">53.00</td>
<td style="text-align: right;">106.00</td>
<td style="text-align: left;">▁▇▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">case_zip</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30249.72</td>
<td style="text-align: right;">123.83</td>
<td style="text-align: right;">30000.0</td>
<td style="text-align: right;">30213.00</td>
<td style="text-align: right;">30312.00</td>
<td style="text-align: right;">30331.00</td>
<td style="text-align: right;">31707.00</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">latitude_jitt</td>
<td style="text-align: right;">94</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">32.58</td>
<td style="text-align: right;">6.38</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">33.69</td>
<td style="text-align: right;">33.78</td>
<td style="text-align: right;">33.98</td>
<td style="text-align: right;">34.19</td>
<td style="text-align: left;">▁▁▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">longitude_jitt</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-81.39</td>
<td style="text-align: right;">15.65</td>
<td style="text-align: right;">-84.8</td>
<td style="text-align: right;">-84.46</td>
<td style="text-align: right;">-84.38</td>
<td style="text-align: right;">-84.35</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age_recalc</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">39.02</td>
<td style="text-align: right;">19.09</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">25.00</td>
<td style="text-align: right;">36.00</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: right;">105.00</td>
<td style="text-align: left;">▃▇▅▂▁</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">reprt_creationdt</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">2019-12-27</td>
<td style="text-align: left;">2021-07-27</td>
<td style="text-align: left;">2020-12-04</td>
<td style="text-align: right;">533</td>
</tr>
<tr class="even">
<td style="text-align: left;">case_dob</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">1914-12-28</td>
<td style="text-align: left;">2021-05-13</td>
<td style="text-align: left;">1984-05-03</td>
<td style="text-align: right;">26713</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sym_startdt</td>
<td style="text-align: right;">37480</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: left;">1941-03-08</td>
<td style="text-align: left;">2030-12-03</td>
<td style="text-align: left;">2020-11-22</td>
<td style="text-align: right;">601</td>
</tr>
<tr class="even">
<td style="text-align: left;">sym_resolveddt</td>
<td style="text-align: right;">65799</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">2001-11-08</td>
<td style="text-align: left;">2102-02-03</td>
<td style="text-align: left;">2020-11-27</td>
<td style="text-align: right;">612</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hosp_admidt</td>
<td style="text-align: right;">77115</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: left;">2019-12-26</td>
<td style="text-align: left;">2032-05-22</td>
<td style="text-align: left;">2020-10-14</td>
<td style="text-align: right;">517</td>
</tr>
<tr class="even">
<td style="text-align: left;">hosp_dischdt</td>
<td style="text-align: right;">78600</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: left;">2019-12-04</td>
<td style="text-align: left;">2029-12-29</td>
<td style="text-align: left;">2020-10-24</td>
<td style="text-align: right;">504</td>
</tr>
<tr class="odd">
<td style="text-align: left;">died_dt</td>
<td style="text-align: right;">80394</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: left;">2020-02-21</td>
<td style="text-align: left;">2021-07-01</td>
<td style="text-align: left;">2020-12-11</td>
<td style="text-align: right;">429</td>
</tr>
<tr class="even">
<td style="text-align: left;">pos_sampledt</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">2020-02-01</td>
<td style="text-align: left;">2021-07-23</td>
<td style="text-align: left;">2020-12-03</td>
<td style="text-align: right;">526</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> case_age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> age_recalc)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/outbreak_report/post_files/figure-html/explore_data-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>case_age, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>age_recalc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9996529</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(case_age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">View</span>()</span>
<span id="cb10-4"></span>
<span id="cb10-5">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sym_startdt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> sym_resolveddt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(sym_startdt)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(case_dob, reprt_creationdt, case_age, age_recalc, sym_startdt, sym_resolveddt)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      case_dob reprt_creationdt case_age age_recalc sym_startdt sym_resolveddt
1   1973-12-12       2021-03-19       47         47  2030-12-03     2020-12-28
2   1949-02-08       2020-12-09       72         71  2028-12-09     2020-12-15
3   1950-07-26       2020-12-05       71         70  2021-06-01     2020-12-14
4   1986-09-11       2021-05-27       34         34  2021-05-24     2021-01-11
5   1990-07-10       2021-05-30       31         30  2021-05-21     2021-05-02
6   1985-10-17       2021-01-16       35         35  2021-05-13     2021-01-18
7   2005-03-03       2021-05-14       16         16  2021-05-06     2021-03-14
8   2007-03-11       2021-05-08       14         14  2021-05-03     2020-05-11
9   1993-02-28       2021-04-19       28         28  2021-04-22     2021-04-16
10  2002-08-06       2021-04-07       18         18  2021-04-05     2021-03-30
11  1979-03-17       2021-04-11       42         42  2021-04-01     2021-03-12
12  1994-06-29       2021-04-14       27         26  2021-04-01     2021-02-12
13  1968-03-07       2021-03-23       53         53  2021-03-18     2021-03-10
14  2003-02-15       2021-03-11       18         18  2021-03-13     2020-03-15
15  1998-08-01       2021-03-17       22         22  2021-03-13     2020-03-25
16  2006-09-07       2021-03-15       14         14  2021-03-11     2021-03-09
17  1979-01-09       2021-03-10       42         42  2021-03-08     2020-03-08
18  1996-04-07       2021-03-16       25         24  2021-03-07     2020-03-15
19  1986-10-30       2021-03-09       34         34  2021-03-07     2021-01-07
20  1987-02-10       2021-03-01       34         34  2021-02-26     2021-02-24
21  1997-08-05       2021-03-07       23         23  2021-02-26     2020-03-04
22  2013-01-23       2021-03-02        8          8  2021-02-21     2021-02-20
23  2003-05-17       2021-01-21       18         17  2021-02-18     2021-01-26
24  1955-05-25       2021-02-26       66         65  2021-02-18     2020-02-27
25  1989-03-25       2021-03-10       32         31  2021-02-17     2020-12-25
26  1943-05-11       2021-02-19       78         77  2021-02-16     2021-02-15
27  1984-05-20       2021-02-18       37         36  2021-02-15     2018-02-16
28  1969-11-21       2021-02-13       51         51  2021-02-12     2021-01-22
29  1997-12-28       2021-02-16       23         23  2021-02-11     2021-01-17
30  1990-11-18       2021-02-21       30         30  2021-02-10     2021-02-08
31  1993-07-02       2021-01-13       28         27  2021-02-09     2021-01-18
32  2007-09-02       2021-02-03       13         13  2021-02-05     2021-02-01
33  2020-01-03       2020-04-10        1          0  2021-02-02     2012-02-04
34  1983-01-11       2021-02-08       38         38  2021-02-02     2020-02-17
35  1981-02-13       2021-04-17       40         40  2021-02-02     2021-01-15
36  1984-04-14       2021-01-03       37         36  2021-01-29     2021-01-12
37  1962-02-07       2021-01-31       59         58  2021-01-27     2020-01-31
38  2001-06-20       2021-01-26       20         19  2021-01-26     2020-01-27
39  1984-01-14       2021-01-23       37         37  2021-01-25     2020-01-29
40  1950-01-14       2021-01-27       71         71  2021-01-23     2020-01-28
41  2005-09-18       2021-01-29       15         15  2021-01-22     2020-01-24
42  1972-05-24       2021-02-02       49         48  2021-01-22     2020-01-30
43  1994-01-26       2021-01-31       27         27  2021-01-22     2021-01-01
44  1940-05-24       2021-02-05       81         80  2021-01-21     2021-01-17
45  1986-05-28       2021-03-02       35         34  2021-01-20     2020-02-22
46  1980-10-11       2021-01-18       40         40  2021-01-20     2021-01-18
47  1984-11-21       2020-09-06       36         35  2021-01-19     2020-01-28
48  1988-11-26       2021-01-28       32         32  2021-01-19     2020-12-26
49  1944-10-01       2020-12-22       76         76  2021-01-17     2020-12-29
50  1997-04-08       2021-01-16       24         23  2021-01-17     2021-01-16
51  1992-02-03       2021-01-30       29         28  2021-01-17     2020-12-30
52  1988-04-22       2021-01-26       33         32  2021-01-16     2020-01-23
53  1926-10-21       2021-01-12       94         94  2021-01-15     2021-01-13
54  1962-03-06       2021-01-25       59         58  2021-01-15     2014-02-04
55  1988-12-28       2021-01-16       32         32  2021-01-15     2020-01-18
56  1963-09-01       2021-01-26       57         57  2021-01-14     2020-01-23
57  2001-04-24       2021-01-20       20         19  2021-01-14     2020-01-24
58  1985-04-15       2021-01-15       36         35  2021-01-14     2020-01-21
59  1979-04-20       2021-06-15       42         42  2021-01-14     2020-01-16
60  1990-09-30       2021-01-19       30         30  2021-01-13     2020-02-07
61  1948-06-27       2021-01-16       73         72  2021-01-12     2020-02-03
62  2005-10-05       2021-01-25       15         15  2021-01-12     2020-01-26
63  1986-01-23       2021-01-20       35         34  2021-01-11     2020-01-22
64  1998-12-15       2021-01-22       22         22  2021-01-11     2020-01-25
65  1984-08-24       2021-01-04       36         36  2021-01-10     2021-01-02
66  1964-04-11       2021-01-17       57         56  2021-01-06     2020-01-23
67  1985-04-22       2021-01-10       36         35  2021-01-06     2020-12-29
68  1980-09-01       2021-01-06       40         40  2021-01-05     2020-01-07
69  1970-05-01       2021-01-11       51         50  2021-01-05     2020-01-10
70  1965-03-02       2021-01-11       56         55  2021-01-05     2020-01-10
71  1980-10-18       2021-01-08       40         40  2021-01-05     2020-01-09
72  1989-12-16       2021-01-12       31         31  2021-01-04     2020-01-17
73  1981-01-03       2021-01-08       40         40  2021-01-03     2020-01-13
74  1938-01-25       2021-01-08       83         82  2021-01-03     2020-01-17
75  1979-12-12       2021-01-19       41         41  2021-01-02     2020-12-19
76  1982-08-09       2021-01-02       38         38  2020-12-31     2020-01-04
77  1979-03-04       2021-01-03       42         41  2020-12-30     2020-12-21
78  1976-09-15       2020-12-02       44         44  2020-12-28     2020-12-14
79  1956-02-14       2021-01-09       65         64  2020-12-28     2020-01-19
80  1996-04-05       2020-12-31       25         24  2020-12-27     2020-01-14
81  1971-10-25       2020-12-31       49         49  2020-12-27     2020-01-14
82  1982-03-23       2021-01-01       39         38  2020-12-26     2020-01-05
83  1976-04-06       2020-12-31       45         44  2020-12-25     2020-12-21
84  1967-02-22       2021-01-05       54         53  2020-12-25     2020-12-24
85  1959-03-02       2020-12-23       62         61  2020-12-24     2020-11-08
86  1981-05-23       2020-12-30       40         39  2020-12-24     2019-12-29
87  1950-09-07       2020-12-29       70         70  2020-12-22     2014-01-06
88  1988-08-03       2020-12-31       32         32  2020-12-22     2020-10-25
89  1997-09-29       2020-12-21       23         23  2020-12-21     2020-12-20
90  1955-05-25       2020-12-23       66         65  2020-12-20     2019-12-22
91  2011-05-21       2021-01-04       10          9  2020-12-16     2020-01-04
92  1973-05-10       2020-12-22       48         47  2020-12-16     2019-12-21
93  1972-05-15       2020-12-16       49         48  2020-12-14     2020-11-30
94  1965-03-20       2020-12-22       56         55  2020-12-14     2020-11-27
95  1963-03-21       2020-12-20       58         57  2020-12-14     2019-12-19
96  1971-09-01       2020-07-21       49         48  2020-12-12     2020-08-14
97  1969-01-05       2020-12-17       52         51  2020-12-12     2019-12-20
98  1993-07-24       2020-12-17       27         27  2020-12-08     2019-12-26
99  2004-01-26       2020-12-15       17         16  2020-12-07     2019-12-12
100 1945-08-28       2020-12-12       75         75  2020-12-06     2019-12-14
101 1966-05-03       2020-12-20       55         54  2020-12-02     2019-12-15
102 1993-01-02       2020-11-29       28         27  2020-12-01     2020-11-28
103 1954-10-22       2020-12-16       66         66  2020-12-01     2019-12-17
104 1990-12-14       2020-12-05       30         29  2020-11-27     2020-11-11
105 2002-10-13       2020-12-03       18         18  2020-11-27     2020-07-31
106 2000-03-03       2020-12-03       21         20  2020-11-26     2019-12-06
107 1946-07-18       2020-11-22       75         74  2020-11-24     2020-11-11
108 1972-06-19       2021-05-12       49         48  2020-11-21     2019-12-16
109 1995-01-27       2020-11-23       26         25  2020-11-19     2020-10-24
110 2008-11-01       2020-11-21       12         12  2020-11-17     2020-02-17
111 1976-01-09       2020-07-26       45         44  2020-11-15     2020-07-29
112 1934-06-18       2020-11-18       87         86  2020-11-14     2020-11-08
113 1984-04-23       2020-11-16       37         36  2020-11-11     2020-10-23
114 1963-07-27       2020-11-19       58         57  2020-11-11     2020-10-24
115 2003-10-09       2020-11-20       17         17  2020-11-08     2020-11-07
116 1986-02-08       2020-11-08       35         34  2020-11-05     2020-11-04
117 1995-06-05       2020-11-06       26         25  2020-10-31     2001-11-08
118 1986-02-28       2020-11-07       35         34  2020-10-27     2020-10-09
119 1984-08-04       2020-04-22       36         35  2020-10-19     2020-05-11
120 1983-03-07       2020-10-12       38         37  2020-10-10     2020-10-09
121 1991-10-21       2020-07-22       29         28  2020-10-09     2020-07-22
122 2003-05-04       2020-10-18       18         17  2020-10-09     2020-09-29
123 2002-06-20       2020-07-24       19         18  2020-10-04     2020-07-30
124 1990-02-26       2020-10-20       31         30  2020-10-03     2002-10-23
125 1992-11-21       2020-10-06       28         27  2020-09-29     2020-09-13
126 1993-10-15       2020-09-30       27         26  2020-09-28     2020-08-01
127 1998-07-09       2020-09-24       23         22  2020-09-27     2020-09-21
128 1973-05-05       2020-09-21       48         47  2020-09-20     2020-09-14
129 1982-08-23       2020-09-02       38         38  2020-09-14     2020-08-29
130 1996-05-02       2020-09-17       25         24  2020-09-13     2020-09-12
131 1998-03-27       2020-07-13       23         22  2020-09-09     2020-07-18
132 1998-11-10       2020-09-16       22         21  2020-09-07     2020-07-11
133 1981-06-20       2020-09-08       40         39  2020-09-04     2020-08-27
134 1975-08-22       2020-08-10       45         44  2020-08-25     2020-08-06
135 1986-09-08       2020-09-01       34         33  2020-08-25     2020-07-05
136 2002-10-09       2020-10-07       18         17  2020-08-24     2020-08-07
137 1937-09-11       2020-09-01       83         82  2020-08-22     2020-07-04
138 1995-01-09       2020-08-24       26         25  2020-08-19     2020-06-19
139 1991-03-28       2020-07-21       30         29  2020-08-17     2020-07-20
140 1995-03-14       2020-08-16       26         25  2020-08-15     2020-08-13
141 1997-03-18       2020-09-05       24         23  2020-08-15     2020-07-30
142 1975-02-15       2020-08-16       46         45  2020-08-14     2020-07-25
143 1968-01-14       2020-08-22       53         52  2020-08-13     2020-08-01
144 1991-07-13       2020-08-04       30         29  2020-08-12     2020-07-21
145 1985-10-24       2020-07-22       35         34  2020-08-11     2020-07-17
146 1992-11-12       2020-07-16       28         27  2020-08-06     2020-07-16
147 1951-04-11       2020-08-15       70         69  2020-08-05     2020-05-07
148 2017-11-21       2020-08-15        3          2  2020-08-01     2020-07-12
149 1986-01-19       2020-07-16       35         34  2020-08-01     2020-07-13
150 1993-01-28       2020-08-04       28         27  2020-08-01     2020-07-30
151 2002-01-28       2020-07-15       19         18  2020-07-31     2020-07-18
152 1980-12-22       2020-08-04       40         39  2020-07-31     2020-07-29
153 1994-07-05       2020-08-05       27         26  2020-07-29     2020-07-06
154 1994-10-27       2020-08-01       26         25  2020-07-28     2020-07-10
155 1996-02-21       2020-07-27       25         24  2020-07-28     2020-07-23
156 1993-05-07       2020-07-11       28         27  2020-07-27     2020-07-01
157 1992-11-10       2020-08-11       28         27  2020-07-26     2020-07-15
158 1987-07-01       2020-07-16       34         33  2020-07-25     2020-06-29
159 1978-01-24       2020-08-07       43         42  2020-07-25     2020-02-10
160 2006-02-15       2020-08-04       15         14  2020-07-23     2020-06-30
161 1947-10-12       2020-07-21       73         72  2020-07-22     2020-07-17
162 1987-07-31       2020-07-24       33         32  2020-07-21     2020-06-23
163 1981-04-11       2020-07-16       40         39  2020-07-20     2020-06-30
164 1985-11-03       2020-06-30       35         34  2020-07-18     2020-07-03
165 1992-05-08       2020-07-30       29         28  2020-07-17     2020-07-01
166 1969-03-09       2020-07-10       52         51  2020-07-17     2020-06-24
167 1980-06-06       2020-07-15       41         40  2020-07-17     2020-07-15
168 1972-07-03       2020-07-18       49         48  2020-07-16     2020-06-30
169 2007-02-06       2020-07-18       14         13  2020-07-15     2020-07-14
170 1990-07-19       2020-07-14       31         29  2020-07-14     2020-06-26
171 1989-06-07       2020-07-14       32         31  2020-07-11     2020-06-16
172 1988-06-08       2020-07-12       33         32  2020-07-10     2020-06-22
173 2006-11-24       2020-06-17       14         13  2020-07-09     2020-06-15
174 1994-05-27       2020-07-24       27         26  2020-07-09     2020-01-23
175 1977-01-15       2020-07-17       44         43  2020-07-09     2012-07-05
176 2005-03-09       2020-07-11       16         15  2020-07-08     2020-07-06
177 1958-11-12       2020-07-27       62         61  2020-07-07     2020-06-13
178 1988-01-29       2020-07-30       33         32  2020-07-07     2019-12-19
179 1969-03-09       2020-07-05       52         51  2020-06-30     2002-07-03
180 1971-05-06       2020-06-19       50         49  2020-06-30     2020-06-24
181 1983-12-05       2020-06-29       37         36  2020-06-26     2020-06-08
182 1994-12-07       2020-07-15       26         25  2020-06-25     2020-06-13
183 1971-11-17       2020-07-23       49         48  2020-06-25     2020-06-09
184 2001-01-29       2020-06-27       20         19  2020-06-24     2020-06-23
185 1987-12-04       2020-06-06       33         32  2020-06-20     2020-06-03
186 2000-12-17       2020-07-02       20         19  2020-06-20     2020-06-11
187 2004-03-26       2020-06-22       17         16  2020-06-19     2020-05-23
188 2008-03-01       2020-07-04       13         12  2020-06-18     2020-06-16
189 1977-05-06       2020-06-26       44         43  2020-06-12     2020-03-25
190 1990-05-02       2020-06-24       31         30  2020-06-08     2020-05-29
191 1967-01-15       2020-06-18       54         53  2020-06-07     2020-03-10
192 1979-02-11       2020-06-22       42         41  2020-06-05     2020-06-04
193 2006-11-09       2020-06-19       14         13  2020-06-05     2020-05-20
194 1957-06-28       2020-06-05       64         62  2020-06-01     2020-05-30
195 1983-01-06       2020-06-03       38         37  2020-05-30     2020-05-04
196 1993-04-06       2020-05-31       28         27  2020-05-28     2010-06-19
197 1995-07-29       2020-06-01       25         24  2020-05-25     2020-05-23
198 1987-02-27       2020-05-05       34         33  2020-04-26     2020-04-01
199 2003-06-17       2020-05-09       18         16  2020-04-25     2020-04-06
200 1986-07-12       2020-03-26       35         33  2020-03-12     2020-03-03
201 1971-10-31       2020-03-11       49         48  2020-03-09     2020-03-07
202 1983-12-13       2020-03-18       37         36  2020-03-06     2020-02-12</code></pre>
</div>
</div>



 ]]></description>
  <category>R</category>
  <category>report</category>
  <category>Quarto</category>
  <guid>https://CarlosEpiStats.github.io/blog/posts/outbreak_report/post.html</guid>
  <pubDate>Mon, 11 Mar 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Create an Alluvial Plot in Stata</title>
  <dc:creator>Carlos Fernández</dc:creator>
  <link>https://CarlosEpiStats.github.io/blog/posts/alluvial_plot_stata/post.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this post, I explain how to create an alluvial plot using code in Stata.</p>
<section id="what-is-an-alluvial-diagram" class="level2">
<h2 class="anchored" data-anchor-id="what-is-an-alluvial-diagram">What is an Alluvial Diagram</h2>
<p>An alluvial diagram or plot displays the flow of information from one categorical variable or stage to the next. The term “alluvial” refers to its resemblance to the flow of a river.</p>
</section>
<section id="uses-of-alluvial-diagrams" class="level2">
<h2 class="anchored" data-anchor-id="uses-of-alluvial-diagrams">Uses of Alluvial Diagrams</h2>
<p>Alluvial diagrams are commonly used in the following situations:</p>
<ul>
<li>To demonstrate the number of participants in a study transitioning from one baseline category to a subsequent category. For example, the number of participants randomized at the beginning of the study and who continue to follow-up at the end. It serves as a graphical supplement to flowcharts, which present information with arrows and boxes containing text and numbers.</li>
<li>To show the distribution of participants among different categorical variables. In this case, it provides a more “visually appealing” alternative to stacked column charts.</li>
</ul>
</section>
</section>
<section id="stata-code" class="level1">
<h1>Stata Code</h1>
<section id="preparations" class="level2">
<h2 class="anchored" data-anchor-id="preparations">Preparations</h2>
<p>For this example, we will use the <code>alluvial</code> command, which requires the installation of the <code>palettes</code> and <code>colrspace</code> commands. The data is a simulation of a comparison of two fictional diagnostic tests, called “Test A” and “Test B”, which can take values such as “1-very low”, “2-low”, “3-medium”, “4-high”, and “5-very high”.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Install user-written commands</span></span>
<span id="cb1-2">net install alluvial, from(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/asjadnaqvi/stata-alluvial/main/installation/"</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">replace</span></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">ssc</span> install palettes, <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">replace</span></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">ssc</span> install colrspace, <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">replace</span></span></code></pre></div>
</details>
</div>
<div class="cell" data-execution_count="2">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Input data</span></span>
<span id="cb2-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">clear</span></span>
<span id="cb2-3"></span>
<span id="cb2-4">input test_b test_a</span>
<span id="cb2-5">    4   4</span>
<span id="cb2-6">    1   1</span>
<span id="cb2-7">    1   1</span>
<span id="cb2-8">    2   2</span>
<span id="cb2-9">    3   1</span>
<span id="cb2-10">    1   2</span>
<span id="cb2-11">    3   2</span>
<span id="cb2-12">    2   2</span>
<span id="cb2-13">    5   2</span>
<span id="cb2-14">    3   1</span>
<span id="cb2-15">    3   3</span>
<span id="cb2-16">    3   3</span>
<span id="cb2-17">    5   3</span>
<span id="cb2-18">    4   3</span>
<span id="cb2-19">    1   1</span>
<span id="cb2-20">    3   3</span>
<span id="cb2-21">    4   1</span>
<span id="cb2-22">    2   3</span>
<span id="cb2-23">    5   2</span>
<span id="cb2-24">    4   2</span>
<span id="cb2-25">    4   2</span>
<span id="cb2-26">    2   1</span>
<span id="cb2-27">    5   3</span>
<span id="cb2-28">    3   3</span>
<span id="cb2-29">    5   1</span>
<span id="cb2-30">    3   3</span>
<span id="cb2-31"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb2-32"></span>
<span id="cb2-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Label data</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">label</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">var</span> test_a <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test A"</span></span>
<span id="cb2-36"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">label</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">var</span> test_b <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test B"</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">label</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">define</span> high_low 1 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1-very low"</span> 2 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2-low"</span> 3 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3-medium"</span> 4 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4-high"</span> 5 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5-very high"</span>, <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">replace</span></span>
<span id="cb2-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">label</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">values</span> test_a test_b high_low</span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Tabulate</span></span>
<span id="cb2-42"></span>
<span id="cb2-43"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">tab</span> test_a test_b</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

            |                   Test B
     Test A | 1-very lo      2-low   3-medium     4-high |     Total
------------+--------------------------------------------+----------
 1-very low |         3          1          2          1 |         8 
      2-low |         1          2          1          2 |         8 
   3-medium |         0          1          5          1 |         9 
     4-high |         0          0          0          1 |         1 
------------+--------------------------------------------+----------
      Total |         4          4          8          5 |        26 


            |   Test B
     Test A | 5-very hi |     Total
------------+-----------+----------
 1-very low |         1 |         8 
      2-low |         2 |         8 
   3-medium |         2 |         9 
     4-high |         0 |         1 
------------+-----------+----------
      Total |         5 |        26 </code></pre>
</div>
</div>
<p>In this fictional study, a total of 26 people underwent both diagnostic tests. We can see in the table that three people obtained a “very low” result in both tests, one person obtained a “very low” result in test A and “low” in test B, etc.</p>
<p>The table itself is informative but does not allow for quick and intuitive information extraction. This is where the alluvial plot comes in.</p>
</section>
<section id="alluvial-plot" class="level2">
<h2 class="anchored" data-anchor-id="alluvial-plot">Alluvial Plot</h2>
<div class="cell" data-execution_count="3">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Alluvial plot</span></span>
<span id="cb4-2"></span>
<span id="cb4-3">alluvial test_a test_b, <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">palette</span>(RdYlBu, n(5)) labangle(0) novalues boxwidth(5) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">offset</span>(10) <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alluvial plot of results of Test A vs Test B."</span>, <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">size</span>(3)) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">note</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N = 26"</span>) graphregion(<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">color</span>(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">white</span>)) showtot lwidth(0.01) lcolor(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">gray</span>) labpos(3)</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">qui</span>: <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">graph</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">export</span> fig1.svg, <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">width</span>(1600) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">replace</span></span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/alluvial_plot_stata/fig1.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">alluvial_plot</figcaption>
</figure>
</div>
<p>In the alluvial diagram, the area of the colored zones is proportional to the frequency, so wider “flows” represent more participants.</p>
<p>The graph shows how there is a considerable “transfer” of participants between result levels in the two tests. For example, we see that slightly less than half of those with a “very low” result in Test A also obtained “very low” in Test B, but others obtained “low”, “medium”, “high”, and even “very high” results. We also clearly see how there are no participants with “very high” results in Test A, or that the only participant with a “high” result in Test A also had a “high” result in Test B.</p>
<p>In conclusion, alluvial diagrams provide a visual option for better understanding data flows between categories.</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><a href="https://github.com/asjadnaqvi/stata-alluvial">alluvial Stata package</a></li>
<li><a href="https://friosavila.github.io/stata_do/stata_do1.html">This post explains how to run Stata code using Quarto</a></li>
</ul>


</section>

 ]]></description>
  <category>Stata</category>
  <category>plot</category>
  <category>alluvial</category>
  <guid>https://CarlosEpiStats.github.io/blog/posts/alluvial_plot_stata/post.html</guid>
  <pubDate>Sun, 10 Mar 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Interactive List of Japanese Words Using R Shiny Apps</title>
  <dc:creator>Carlos Fernández</dc:creator>
  <link>https://CarlosEpiStats.github.io/blog/posts/kanji_app/post.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In a <a href="https://carlosepistats.github.io/blog/posts/kanji/post.html">previous post</a>, I demonstrated how to use R to load, explore, and filter data from a dataset containing Japanese characters, known as “kanji”.</p>
<p>Today, we’ll focus on making that data exploration interactive using the R package <code>shiny</code>.</p>
</section>
<section id="app-design" class="level1">
<h1>App Design</h1>
<p>Every interactive app has at least three components: input, output, and a back-end server. The server transforms the user’s input into output. My “kanji app” has the following input and output:</p>
<p><strong>Input</strong>:</p>
<ul>
<li>A list of kanji that the user is currently learning.</li>
</ul>
<p><strong>Output</strong>:</p>
<ul>
<li>A table with all the possible words formed by combination of those kanji, as well as their pronunciation and an English translation. This table can be downloaded in CSV or XLSX format.</li>
<li>A table with example sentences that contain words formed by combination of those kanji, as well as their pronunciation and an English translation.</li>
<li>A table that displays how many different words contain each of the learning kanji.</li>
</ul>
</section>
<section id="shiny-app" class="level1">
<h1>Shiny App</h1>
<p>Here you can find the embedded version of this Shiny app. To access the full screen version, click on <a href="https://epistats.shinyapps.io/Kanji_app/">this link</a>.</p>
 <iframe id="example1" src="https://epistats.shinyapps.io/Kanji_app/" style="border: 1px solid black; width: 100%; height: 720px"></iframe>
</section>
<section id="code-breakdown" class="level1">
<h1>Code Breakdown</h1>
<section id="setup-and-loading-data" class="level2">
<h2 class="anchored" data-anchor-id="setup-and-loading-data">Setup and Loading Data</h2>
<p>To begin, we need to load the necessary libraries and import the datasets. I’ll use five different datasets to form the whole “dictionary”:</p>
<ul>
<li>A list of kanji downloaded from <a href="https://www.kanjidatabase.com/index.php">Kanji database</a></li>
<li>A list of jukugo (words composed by two kanji) downloaded from <a href="https://www.kanjidatabase.com/index.php">Kanji database</a></li>
<li>A list of words obtained from an Anki deck from <a href="https://ankiweb.net/shared/info/2141233552">here</a></li>
<li>A list of sentences obtained from an Anki deck from <a href="https://ankiweb.net/shared/info/1880390099">here</a></li>
<li>A dataset of Japanese numbers from 0 to 100, created manually.</li>
</ul>
<p>Each dataset contains three columns: <code>word</code> (in kanji), <code>pronunciation</code> (in hiragana or romaji), and <code>meaning</code> (in English).</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loading necessary libraries ####</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(janitor)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(writexl)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shiny)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(flextable)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loading datasets ####</span></span>
<span id="cb1-12"></span>
<span id="cb1-13">file_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kanji_20240227_081842.csv"</span></span>
<span id="cb1-14">file_jukugo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jukugo_20240227_081908.csv"</span></span>
<span id="cb1-15">file_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Optimized Kore - Sheet1.csv"</span></span>
<span id="cb1-16">file_sentences1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sentences.xlsx"</span></span>
<span id="cb1-17">file_sentences2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sentences_core.xlsx"</span></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Kanji list ####</span></span>
<span id="cb1-20">data_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/kanji"</span>, file_kanji)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Jukugo list ####</span></span>
<span id="cb1-24">data_jukugo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/kanji"</span>, file_jukugo)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(frequency)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(comp_word, pronunciation, english_translation) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">word =</span> comp_word,</span>
<span id="cb1-29">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meaning =</span> english_translation) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(word, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep_all =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-31">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change romaji</span></span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb1-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ji"</span>, pronunciation),</span>
<span id="cb1-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jy"</span>, pronunciation),</span>
<span id="cb1-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ti"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chi"</span>, pronunciation),</span>
<span id="cb1-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ty"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch"</span>, pronunciation),</span>
<span id="cb1-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"si"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shi"</span>, pronunciation),</span>
<span id="cb1-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shy"</span>, pronunciation),</span>
<span id="cb1-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tsu"</span>, pronunciation),</span>
<span id="cb1-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fu"</span>, pronunciation)</span>
<span id="cb1-41">    )</span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## word list ####</span></span>
<span id="cb1-44">data_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/kanji"</span>, file_words)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(core_index) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(vocab_expression, vocab_kana, vocab_meaning) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">word =</span> vocab_expression,</span>
<span id="cb1-49">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> vocab_kana,</span>
<span id="cb1-50">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meaning =</span> vocab_meaning) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(word, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep_all =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Number list ####</span></span>
<span id="cb1-54"></span>
<span id="cb1-55">data_numbers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb1-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">word =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"零"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十"</span>, </span>
<span id="cb1-57">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十九"</span>, </span>
<span id="cb1-58">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十七"</span>, </span>
<span id="cb1-59">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二十九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十五"</span>, </span>
<span id="cb1-60">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三十九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十三"</span>, </span>
<span id="cb1-61">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"四十九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十一"</span>, </span>
<span id="cb1-62">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五十九"</span>, </span>
<span id="cb1-63">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十七"</span>, </span>
<span id="cb1-64">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"六十九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十五"</span>, </span>
<span id="cb1-65">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"七十九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十三"</span>, </span>
<span id="cb1-66">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"八十九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十一"</span>, </span>
<span id="cb1-67">     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十四"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十五"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十六"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十七"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十八"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"九十九"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"百"</span>),</span>
<span id="cb1-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pronunciation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"れい"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"いち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"に"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"し"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅう"</span>,</span>
<span id="cb1-69">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"じゅうきゅう"</span>,</span>
<span id="cb1-70">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"にじゅうきゅう"</span>,</span>
<span id="cb1-71">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"さんじゅうきゅう"</span>,</span>
<span id="cb1-72">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"よんじゅうきゅう"</span>,</span>
<span id="cb1-73">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ごじゅうきゅう"</span>,</span>
<span id="cb1-74">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ろくじゅうきゅう"</span>,</span>
<span id="cb1-75">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"しちじゅうきゅう"</span>,</span>
<span id="cb1-76">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"はちじゅうきゅう"</span>,</span>
<span id="cb1-77">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅう"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅういち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうに"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうさん"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうし"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうご"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうろく"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうしち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうはち"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"きゅうじゅうきゅう"</span>,</span>
<span id="cb1-78">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ひゃく"</span>),</span>
<span id="cb1-79">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meaning =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb1-80">  )</span>
<span id="cb1-81"></span>
<span id="cb1-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sentence list ####</span></span>
<span id="cb1-83">data_sentences1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/kanji"</span>, file_sentences1)) </span>
<span id="cb1-84">data_sentences2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/kanji"</span>, file_sentences2))</span>
<span id="cb1-85"></span>
<span id="cb1-86">data_sentences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(data_sentences1, data_sentences2)</span>
<span id="cb1-87"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(data_sentences1, data_sentences2)</span>
<span id="cb1-88"></span>
<span id="cb1-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract kana ####</span></span>
<span id="cb1-90"></span>
<span id="cb1-91">hiragana_chars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intToUtf8</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12353</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12438</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unicode range for hiragana characters</span></span>
<span id="cb1-92">katakana_chars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intToUtf8</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12448</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12543</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unicode range for katakana characters</span></span>
<span id="cb1-93"></span>
<span id="cb1-94">kana <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(hiragana_chars, katakana_chars) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split_1</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb1-97"></span>
<span id="cb1-98"></span>
<span id="cb1-99"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All data ####</span></span>
<span id="cb1-100">data_bind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_words <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(data_sentences <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(word, pronunciation, meaning),</span>
<span id="cb1-102">        data_numbers,</span>
<span id="cb1-103">        data_jukugo) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">word =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(word, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[ a-zA-Z]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(word, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep_all =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb1-106"></span>
<span id="cb1-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract kanji ####</span></span>
<span id="cb1-108"></span>
<span id="cb1-109">all_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_kanji <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(kanji) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(data_bind <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-112">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kanji =</span> word, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kanji =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(kanji, kana)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(kanji <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-116">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-117">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split_1</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb1-119">  </span>
<span id="cb1-120"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Separate individual kanji from all words ####</span></span>
<span id="cb1-121">data_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_bind <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kanji =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(word, kana)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-123">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_wider_position</span>(kanji, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kanji_1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb1-124">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kanji_2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-125">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kanji_3"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb1-126">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kanji_4"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb1-127">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kanji_5"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb1-128">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">too_few =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"align_start"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_1))</span>
<span id="cb1-130"></span>
<span id="cb1-131"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flextable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(data_all))</span></code></pre></div>
</details>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-1864bdba{}.cl-185467bc{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1857bade{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1857cff6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1857d000{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1857d001{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-1864bdba"><thead><tr style="overflow-wrap:break-word;"><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">word</span></p></th><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">pronunciation</span></p></th><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">meaning</span></p></th><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">kanji_1</span></p></th><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">kanji_2</span></p></th><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">kanji_3</span></p></th><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">kanji_4</span></p></th><th class="cl-1857cff6"><p class="cl-1857bade"><span class="cl-185467bc">kanji_5</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">見る</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">みる</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">see, look at</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">見</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">円</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">えん</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">circle</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">円</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">多い</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">おおい</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">lots of</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">多</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">家</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">うち</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">house, home</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">家</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">新しい</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">あたらしい</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">new</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc">新</span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d000"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc">私</span></p></td><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc">わたし</span></p></td><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc">I</span></p></td><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc">私</span></p></td><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td><td class="cl-1857d001"><p class="cl-1857bade"><span class="cl-185467bc"></span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Here’s a breakdown of the final “dictionary”:</p>
<ul>
<li><code>word</code>: This column contains the Japanese word.</li>
<li><code>pronunciation</code>: It shows the pronunciation of the word.</li>
<li><code>meaning</code>: This column provides the English translation or meaning of the word.</li>
<li><code>kanji_1</code>, <code>kanji_2</code>, <code>kanji_3</code>, <code>kanji_4</code>, <code>kanji_5</code>: These columns represents the kanji characters that compose each word.</li>
</ul>
<p>Each row corresponds to a different Japanese word, and the columns contain related information about each word, including its pronunciation, meaning in English, and associated kanji characters.</p>
<p>For example:</p>
<ul>
<li>The word “見る” (miru) means “see, look at”, and its associated kanji is “見”.</li>
<li>The word “円” (en) means “circle”, and its associated kanji is “円”.</li>
<li>The word “多い” (ooi) means “lots of”, and its associated kanji is “多”.</li>
</ul>
</section>
<section id="custom-functions-to-create-the-study-table" class="level2">
<h2 class="anchored" data-anchor-id="custom-functions-to-create-the-study-table">Custom Functions to Create the Study Table</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Functions ####</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">make_study_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(kanji_learning) {</span>
<span id="cb2-4">  </span>
<span id="cb2-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select words with only those kanji</span></span>
<span id="cb2-6">  study_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_all <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(kanji_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> kanji_learning,  </span>
<span id="cb2-8">             kanji_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> kanji_learning <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_2),</span>
<span id="cb2-9">             kanji_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> kanji_learning <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_3),</span>
<span id="cb2-10">             kanji_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> kanji_learning <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_4),</span>
<span id="cb2-11">             kanji_5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> kanji_learning <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_5)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kanji_"</span>))</span>
<span id="cb2-13">  </span>
<span id="cb2-14">  study_words</span>
<span id="cb2-15">}</span>
<span id="cb2-16"></span>
<span id="cb2-17"></span>
<span id="cb2-18">make_sentences_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(kanji_learning) {</span>
<span id="cb2-19">  </span>
<span id="cb2-20">  kanji_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(kanji_learning, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb2-21">  </span>
<span id="cb2-22">  letters_lower <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(letters, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb2-23">  letters_upper <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(LETTERS, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb2-24">  numbers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb2-25">  symbols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"。|、|「|」|？|!|%|！|々"</span></span>
<span id="cb2-26">  </span>
<span id="cb2-27">  other_characters <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(letters_lower, letters_upper, numbers, symbols), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb2-28">  </span>
<span id="cb2-29">  sentences_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_sentences <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">only_kanji =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(sentence, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(kana, other_characters, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)),</span>
<span id="cb2-31">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unknown_kanji =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(only_kanji, kanji_list)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(unknown_kanji <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(kanji_list, sentence)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(sentence, sentence_hiragana, sentence_meaning)</span>
<span id="cb2-34">  </span>
<span id="cb2-35">  sentences_list</span>
<span id="cb2-36">  </span>
<span id="cb2-37">}</span></code></pre></div>
</details>
</div>
<p>This code defines two functions: <code>make_study_list</code> and <code>make_sentences_list</code>. Let’s break down what each function does:</p>
<ol type="1">
<li><strong><code>make_study_list</code> function</strong>:</li>
</ol>
<ul>
<li><strong>Input</strong>: <code>kanji_learning</code> is a vector containing the kanji characters that the user wants to learn.</li>
<li><strong>Output</strong>: <code>study_words</code> is a data frame containing words from <code>data_all</code> dataset that contain only the kanji characters specified in <code>kanji_learning</code>.</li>
<li><strong>Functionality</strong>:
<ul>
<li>Filters the <code>data_all</code> dataset to select words that contain only the kanji characters specified in <code>kanji_learning</code>.</li>
<li>This is done by filtering the rows where each kanji column (<code>kanji_1</code>, <code>kanji_2</code>, <code>kanji_3</code>, <code>kanji_4</code>, <code>kanji_5</code>) matches one of the kanji characters in <code>kanji_learning</code>, or where the kanji column is <code>NA</code> (missing).</li>
<li>Removes the <code>kanji_</code> columns from the resulting dataset.</li>
<li>Returns the filtered dataset containing only the selected words.</li>
</ul></li>
</ul>
<ol start="2" type="1">
<li><strong><code>make_sentences_list</code> function</strong>:</li>
</ol>
<ul>
<li><strong>Input</strong>: <code>kanji_learning</code> is a vector containing the kanji characters that the user wants to learn.</li>
<li><strong>Output</strong>: <code>sentences_list</code> is a data frame containing sentences from <code>data_sentences</code> dataset that contain kanji characters specified in <code>kanji_learning</code>.</li>
<li><strong>Functionality</strong>:
<ul>
<li>Concatenates the kanji characters in <code>kanji_learning</code> into a single regular expression pattern <code>kanji_list</code>.</li>
<li>Defines regular expression patterns for lowercase letters, uppercase letters, numbers, and symbols.</li>
<li>Uses these patterns to define other_characters, which includes all characters that are not kanji.</li>
<li>For each sentence in <code>data_sentences</code>, removes all characters that are not kanji, then removes all kanji characters that are not in <code>kanji_learning</code>.</li>
<li>Filters the sentences to keep only those that contain kanji characters specified in <code>kanji_learning</code>.</li>
<li>Selects the filtered sentences along with their corresponding hiragana representation and meaning.</li>
</ul></li>
<li><strong>Note</strong>: The <code>str_remove_all</code> function from the stringr package is used to remove all occurrences of a pattern from a string.</li>
</ul>
<p>These functions are designed to help users generate study lists of words and sentences containing specific kanji characters they want to learn.</p>
</section>
<section id="shiny-app-code" class="level2">
<h2 class="anchored" data-anchor-id="shiny-app-code">Shiny App Code</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Shiny App ####</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">ui <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fluidPage</span>(</span>
<span id="cb3-4">  </span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">titlePanel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"List Japanese Words Including Selected Kanji"</span>),</span>
<span id="cb3-6">  </span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sidebarLayout</span>(</span>
<span id="cb3-8">    </span>
<span id="cb3-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sidebarPanel</span>(</span>
<span id="cb3-10">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Created by CarlosEpiStats"</span>),</span>
<span id="cb3-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uiOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blog_link"</span>),</span>
<span id="cb3-12">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">downloadButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"downloadExcel"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Download Excel file"</span>),</span>
<span id="cb3-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">downloadButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"downloadCSV"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Download CSV file"</span>),</span>
<span id="cb3-14">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kanji_selected"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Select Kanji:"</span>,  </span>
<span id="cb3-15">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> all_kanji, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">multiple =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-16"></span>
<span id="cb3-17">    ),</span>
<span id="cb3-18">    </span>
<span id="cb3-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mainPanel</span>(</span>
<span id="cb3-20">      </span>
<span id="cb3-21">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tabsetPanel</span>(</span>
<span id="cb3-22">        </span>
<span id="cb3-23">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tabPanel</span>(</span>
<span id="cb3-24">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"List of words"</span>,</span>
<span id="cb3-25">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_kanji"</span>),</span>
<span id="cb3-26">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_words"</span>),</span>
<span id="cb3-27">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DTOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"table_words"</span>)</span>
<span id="cb3-28">          ),</span>
<span id="cb3-29">        </span>
<span id="cb3-30">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tabPanel</span>(</span>
<span id="cb3-31">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"List of sentences"</span>,</span>
<span id="cb3-32">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_sentences"</span>),</span>
<span id="cb3-33">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DTOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"table_sentences"</span>)</span>
<span id="cb3-34">        ),</span>
<span id="cb3-35">        </span>
<span id="cb3-36">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tabPanel</span>(</span>
<span id="cb3-37">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Stats"</span>,</span>
<span id="cb3-38">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tableOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"number_words_per_kanji"</span>)</span>
<span id="cb3-39">        )</span>
<span id="cb3-40">      )</span>
<span id="cb3-41">      </span>
<span id="cb3-42">      </span>
<span id="cb3-43">    )</span>
<span id="cb3-44">  )</span>
<span id="cb3-45">)</span>
<span id="cb3-46"></span>
<span id="cb3-47">server <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(input, output) {</span>
<span id="cb3-48">  </span>
<span id="cb3-49">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Blog link ####</span></span>
<span id="cb3-50">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">a</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CarlosEpiStats"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">href=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://carlosepistats.github.io/blog/"</span>)</span>
<span id="cb3-51"> </span>
<span id="cb3-52">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>blog_link <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderUI</span>({</span>
<span id="cb3-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blog:"</span>, url)</span>
<span id="cb3-54">  })</span>
<span id="cb3-55">  </span>
<span id="cb3-56">  </span>
<span id="cb3-57">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reactive table words ####</span></span>
<span id="cb3-58">  rval_table_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactive</span>({</span>
<span id="cb3-59">    study_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_study_list</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected)</span>
<span id="cb3-60">    study_table</span>
<span id="cb3-61">  })</span>
<span id="cb3-62">  </span>
<span id="cb3-63">  </span>
<span id="cb3-64">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reactive table sentences ####</span></span>
<span id="cb3-65">  rval_table_sentences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactive</span>({</span>
<span id="cb3-66">    study_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_sentences_list</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected)</span>
<span id="cb3-67">    study_table</span>
<span id="cb3-68">  })</span>
<span id="cb3-69">  </span>
<span id="cb3-70">  </span>
<span id="cb3-71">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reactive table counter ####</span></span>
<span id="cb3-72">  rval_table_counter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactive</span>({</span>
<span id="cb3-73">    </span>
<span id="cb3-74">    study_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_all <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-75">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(kanji_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected, </span>
<span id="cb3-76">             kanji_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_2),</span>
<span id="cb3-77">             kanji_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_3),</span>
<span id="cb3-78">             kanji_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_4),</span>
<span id="cb3-79">             kanji_5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(kanji_5))</span>
<span id="cb3-80">    </span>
<span id="cb3-81">    learning_length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected)</span>
<span id="cb3-82">    </span>
<span id="cb3-83">    kanji_counter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb3-84">    </span>
<span id="cb3-85">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>learning_length){</span>
<span id="cb3-86">      </span>
<span id="cb3-87">      kanji_counter[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> study_words <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-88">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(kanji_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> </span>
<span id="cb3-89">                 kanji_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> </span>
<span id="cb3-90">                 kanji_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb3-91">                 kanji_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> </span>
<span id="cb3-92">                 kanji_5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected[i] ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-93">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>()</span>
<span id="cb3-94">      </span>
<span id="cb3-95">    }</span>
<span id="cb3-96">    </span>
<span id="cb3-97">    table_counter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kanji =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected,</span>
<span id="cb3-98">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> kanji_counter)</span>
<span id="cb3-99">    </span>
<span id="cb3-100">    table_counter</span>
<span id="cb3-101">    </span>
<span id="cb3-102">  })</span>
<span id="cb3-103">  </span>
<span id="cb3-104">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reactive number kanji ####</span></span>
<span id="cb3-105">  rval_n_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactive</span>({</span>
<span id="cb3-106">    number_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>kanji_selected)</span>
<span id="cb3-107">    number_words</span>
<span id="cb3-108">  }) </span>
<span id="cb3-109">  </span>
<span id="cb3-110">  </span>
<span id="cb3-111">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reactive number words ####</span></span>
<span id="cb3-112">  rval_n_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactive</span>({</span>
<span id="cb3-113">    study_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_table_words</span>()</span>
<span id="cb3-114">    number_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(study_table)</span>
<span id="cb3-115">    number_words</span>
<span id="cb3-116">  })</span>
<span id="cb3-117">  </span>
<span id="cb3-118">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reactive number sentences ####</span></span>
<span id="cb3-119">  rval_n_sentences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactive</span>({</span>
<span id="cb3-120">    study_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_table_sentences</span>()</span>
<span id="cb3-121">    number_sentences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(study_table)</span>
<span id="cb3-122">    number_sentences</span>
<span id="cb3-123">  })</span>
<span id="cb3-124">  </span>
<span id="cb3-125">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output number words ####</span></span>
<span id="cb3-126">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>n_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderText</span>({</span>
<span id="cb3-127">    n_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_n_words</span>()</span>
<span id="cb3-128">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of words: "</span>, n_words)</span>
<span id="cb3-129">  })</span>
<span id="cb3-130">  </span>
<span id="cb3-131">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output number Kanji ####</span></span>
<span id="cb3-132">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>n_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderText</span>({</span>
<span id="cb3-133">    number_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_n_kanji</span>()</span>
<span id="cb3-134">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of kanji: "</span>, number_kanji)</span>
<span id="cb3-135">  })</span>
<span id="cb3-136">  </span>
<span id="cb3-137">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output number sentences ####</span></span>
<span id="cb3-138">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>n_sentences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderText</span>({</span>
<span id="cb3-139">    number_sentences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_n_sentences</span>()</span>
<span id="cb3-140">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of sentences: "</span>, number_sentences)</span>
<span id="cb3-141">  })</span>
<span id="cb3-142">  </span>
<span id="cb3-143">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output table words ####</span></span>
<span id="cb3-144">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>table_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderDT</span>({</span>
<span id="cb3-145">    study_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_table_words</span>()</span>
<span id="cb3-146">    study_table</span>
<span id="cb3-147">  })</span>
<span id="cb3-148">  </span>
<span id="cb3-149">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output table sentences ####</span></span>
<span id="cb3-150">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>table_sentences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderDT</span>({</span>
<span id="cb3-151">    study_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_table_sentences</span>()</span>
<span id="cb3-152">    study_table</span>
<span id="cb3-153">  })</span>
<span id="cb3-154">  </span>
<span id="cb3-155">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output table counter ####</span></span>
<span id="cb3-156">  </span>
<span id="cb3-157">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>number_words_per_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderTable</span>({</span>
<span id="cb3-158">    table_counter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_table_counter</span>()</span>
<span id="cb3-159">    table_counter</span>
<span id="cb3-160">  })</span>
<span id="cb3-161">  </span>
<span id="cb3-162">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># download Excel ####</span></span>
<span id="cb3-163">  </span>
<span id="cb3-164">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>downloadExcel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">downloadHandler</span>(</span>
<span id="cb3-165">    </span>
<span id="cb3-166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>() {</span>
<span id="cb3-167">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"study_list_k"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_n_kanji</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_w"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_n_words</span>(),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".xlsx"</span>)</span>
<span id="cb3-168">    },</span>
<span id="cb3-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">content =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(file) {</span>
<span id="cb3-170">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_xlsx</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_table_words</span>(), file)</span>
<span id="cb3-171">      </span>
<span id="cb3-172">    })</span>
<span id="cb3-173">  </span>
<span id="cb3-174">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># download CSV ####</span></span>
<span id="cb3-175">  </span>
<span id="cb3-176">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>downloadCSV <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">downloadHandler</span>(</span>
<span id="cb3-177">    </span>
<span id="cb3-178">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>() {</span>
<span id="cb3-179">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"study_list_k"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_n_kanji</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_w"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_n_words</span>(),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".csv"</span>)</span>
<span id="cb3-180">    },</span>
<span id="cb3-181">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">content =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(file) {</span>
<span id="cb3-182">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rval_table_words</span>(), file)</span>
<span id="cb3-183">      </span>
<span id="cb3-184">    })</span>
<span id="cb3-185"></span>
<span id="cb3-186">}</span>
<span id="cb3-187"></span>
<span id="cb3-188"></span>
<span id="cb3-189"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shinyApp</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ui =</span> ui, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">server =</span> server)</span></code></pre></div>
</details>
</div>
<p>This code defines a Shiny web application that allows users to generate lists of Japanese words and sentences containing specific kanji characters they want to learn. Here’s an explanation of the key components:</p>
<ol type="1">
<li><strong>User Interface Definition (<code>ui</code>)</strong>:</li>
</ol>
<ul>
<li>The UI is defined using <code>fluidPage</code> layout.</li>
<li>It consists of a title panel, a sidebar layout with a sidebar panel containing download buttons and a select input to choose kanji characters, and a main panel containing tabs to display the lists of words and sentences.</li>
<li>The tabs include a list of words, a list of sentences, and a stats tab.</li>
<li>Various output elements like text, tables, and DT (DataTables) are defined to display data.</li>
</ul>
<ol start="2" type="1">
<li><strong>Server Logic (<code>server</code>)</strong>:</li>
</ol>
<ul>
<li>The server logic defines the functionality of the Shiny app.</li>
<li>It contains reactive expressions to dynamically update the output elements based on user input.</li>
<li>It defines functions to generate lists of words and sentences based on selected kanji characters (<code>make_study_list</code> and <code>make_sentences_list</code>).</li>
<li>It calculates the number of occurrences of each kanji character in the selected words and displays them in a table on the “Stats” tab.</li>
<li>It provides output functions to display the generated lists of words and sentences.</li>
<li>It includes download handlers to allow users to download the generated lists in Excel and CSV formats.</li>
</ul>
<ol start="3" type="1">
<li><strong>ShinyApp function</strong>:</li>
</ol>
<ul>
<li>The <code>shinyApp</code> function combines the UI and server logic to create the Shiny application.</li>
</ul>
<p>Overall, this Shiny app provides an interactive interface for users to explore and download lists of Japanese words and sentences containing specific kanji characters they are interested in learning.</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><a href="https://www.kanjidatabase.com/index.php">Kanji database</a>.</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>shiny</category>
  <category>exploratory</category>
  <guid>https://CarlosEpiStats.github.io/blog/posts/kanji_app/post.html</guid>
  <pubDate>Tue, 05 Mar 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Loading and Exploring Japanese Kanji Data Using R</title>
  <dc:creator>Carlos Fernández</dc:creator>
  <link>https://CarlosEpiStats.github.io/blog/posts/kanji/post.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this blog post, I’ll demonstrate how to use R to load, explore, and filter data from a dataset containing Japanese characters, known as “kanji”. The datasets were obtained from an online <a href="https://www.kanjidatabase.com/index.php">Kanji database</a>. We’ll focus on using the <code>tidyverse</code> family of packages to illustrate how to select and filter relevant information efficiently.</p>
</section>
<section id="setup-and-loading" class="level1">
<h1>Setup and Loading</h1>
<p>To begin, we need to load necessary libraries and import the datasets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># | warning: false</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loading necessary libraries</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(janitor)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loading datasets</span></span>
<span id="cb1-8"></span>
<span id="cb1-9">data_kanji <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/kanji"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Kanji_20240227_081842.csv"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span>
<span id="cb1-11"></span>
<span id="cb1-12">data_jukugo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/kanji"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jukugo_20240227_081908.csv"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span></code></pre></div>
</div>
<p>Here’s a breakdown of the code:</p>
<ul>
<li><code>library(tidyverse)</code>: We load the <code>tidyverse</code> package, which includes <code>dplyr</code>, <code>ggplot2</code>, and other useful packages.</li>
<li><code>library(here)</code>: This package helps manage file paths conveniently.</li>
<li><code>library(janitor)</code>: Useful for standardizing variable names and data cleaning.</li>
<li>We use <code>read.csv2()</code> to import CSV (comma-separated value) files with semicolons (;) as separators.</li>
<li><code>here("data/kanji", "Kanji_20240227_081842.csv")</code> uses the function <code>here()</code> to access the data file, which is saved inside the folders data &gt; kanji.</li>
<li>The characters <code>%&gt;%</code> are called a “pipe” in tidyverse. It can be written simply by pressing Ctrl + Shift + M (in Windows). Basically, it tells R that we want to apply some step to the previous data. In this example, I tell R that I want to use the function <code>clean_names()</code> to the data that I’ve already loaded using <code>read.csv2()</code>.</li>
<li><code>clean_names()</code> is a <code>janitor</code> function that renames all variables in a standard format to make it easier to manipulate. Specifically, <code>clean_names()</code> sets all names to lowercase, removes punctuation and symbols, and replaces spaces with underscores.</li>
</ul>
<p>Now I have two separate datasets: one for kanji (single characters), and one for jukugo (compound words). Let’s take a look at them.</p>
</section>
<section id="exploring-the-data" class="level1">
<h1>Exploring the data</h1>
<p>Let’s examine the first few rows of each dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(data_kanji)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    id kanji strokes grade
1   41    一       1     1
2  124    乙       1     7
3 2060    了       2     7
4 2074    力       2     1
5 1577    二       2     1
6 1070    人       2     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(data_jukugo)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id comp_word frequency          grammatical_feature pronunciation
1 173      一部     46289 possible to use as an adverb         itibu
2 234      一般     39274                 general noun         ippan
3 432      一時     25126 possible to use as an adverb         itizi
4 461      一番     24155 possible to use as an adverb        itiban
5 481      一緒     23453    light-verb -suru attached         issyo
6 529      一致     21388    light-verb -suru attached          itti
  english_translation position kanji kanji_id
1            one part        L    一       41
2             general        L    一       41
3         one o'clock        L    一       41
4                best        L    一       41
5            together        L    一       41
6         coincidence        L    一       41</code></pre>
</div>
</div>
<p>We’re using the base function <code>head()</code>to show the first rows or observations of our datasets.</p>
<p>We can see that <code>data_kanji</code> has four columns or variables:</p>
<ul>
<li><code>id</code> shows a unique identification number.</li>
<li><code>kanji</code> stores the actual character.</li>
<li><code>strokes</code> represents the number of distinct lines or strokes that the character has.</li>
<li><code>grade</code> means the official categorization of Kanji by educational year in Japan. Grade 1 includes the easiest or most common kanji, and it goes all up to grade 7.</li>
</ul>
<p>On the other hand, <code>data_jukugo</code> contains nine variables:</p>
<ul>
<li><code>id</code> is the identification number for jukugos.</li>
<li><code>comp_word</code> is the actual word.</li>
<li><code>frequency</code> is a measure of how many times each jukugo appear in a selected corpus of Japanese literature (extracted from Japanese newspapers).</li>
<li><code>grammatical_feature</code> gives us more context of how the word is used in grammatical terms.</li>
<li><code>pronunciation</code> tells us the pronunciation in “romaji”, or the Latin alphabet.</li>
<li><code>english_translation</code> stores the English translation.</li>
</ul>
<p>The last three variables in <code>data_jukugo</code> describes the kanji which is part of the jukugo:</p>
<ul>
<li><code>position</code> tells us if the kanji is used in left position “L” or right position “R”.</li>
<li><code>kanji</code> shows the kanji used in the jukugo. The first rows all show jukugos composed with the kanji “一”.</li>
<li><code>kanji_id</code> is the identification number of the kanji part. We can use this id to link <code>data_jukugo</code> with <code>data_kanji</code> if we want to.</li>
</ul>
<p>Another way of looking into a dataset is to explore how each variable is encoded:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(data_kanji)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,136
Columns: 4
$ id      &lt;int&gt; 41, 124, 2060, 2074, 1577, 1070, 1584, 829, 359, 1647, 1903, 1…
$ kanji   &lt;chr&gt; "一", "乙", "了", "力", "二", "人", "入", "七", "九", "八", "…
$ strokes &lt;int&gt; 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3,…
$ grade   &lt;int&gt; 1, 7, 7, 1, 1, 1, 1, 1, 1, 1, 7, 3, 1, 2, 1, 2, 6, 7, 6, 1, 2,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(data_jukugo)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 52,791
Columns: 9
$ id                  &lt;int&gt; 173, 234, 432, 461, 481, 529, 937, 1465, 1521, 156…
$ comp_word           &lt;chr&gt; "一部", "一般", "一時", "一番", "一緒", "一致", "…
$ frequency           &lt;int&gt; 46289, 39274, 25126, 24155, 23453, 21388, 12477, 7…
$ grammatical_feature &lt;chr&gt; "possible to use as an adverb", "general noun", "p…
$ pronunciation       &lt;chr&gt; "itibu", "ippan", "itizi", "itiban", "issyo", "itt…
$ english_translation &lt;chr&gt; "one part", "general", "one o'clock", "best", "tog…
$ position            &lt;chr&gt; "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", …
$ kanji               &lt;chr&gt; "一", "一", "一", "一", "一", "一", "一", "一", "…
$ kanji_id            &lt;int&gt; 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41…</code></pre>
</div>
</div>
<p>The <code>glimpse()</code> function allows us to quickly glance at the data structure.</p>
<p>We can see that <code>data_kanji</code> has 2,136 rows or observations and 4 columns or variables. We also see the first values of each of its four variables. More importantly, we can see which data type each variable stores. The <code>kanji</code> variable has <code>&lt;chr&gt;</code> type, which means “character” or “text”, while the rest of variables have <code>&lt;int&gt;</code> type, which means “integer” number, or a round number. R automatically detects the data types when importing data using functions like <code>read.csv2()</code>.</p>
<p>Regarding <code>data_jukugo</code>, it has 52,791 rows and 9 columns, of which 3 have <code>&lt;int&gt;</code> type, and 6 have <code>&lt;char&gt;</code> type.</p>
</section>
<section id="manipulating-the-data" class="level1">
<h1>Manipulating the data</h1>
<p>Now that I’m familiarized with this dataset, it’s useful to lay down what my analysis plan is. In other words, what do I want to learn from this data? In this case, I want to be able to find words (jukugo) that only contain kanji from a selected list of kanji that I’m learning. So, for example, if I only know kanjis 一, 人, and 十, I want to know all the possible combinations of these three kanjis.</p>
<p>For this exercise, I’m interested in separating jukugos in two parts: the left kanji, and the right kanji. The dataset already has half of this information, but sometimes it tells us the left kanji, and sometimes the right kanji (more on this later). I want to get sistematically both left and right kanjis in the same row, so I’ll create new variables called <code>kanji_left</code> and <code>kanji_right</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">data_jukugo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_jukugo <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kanji_left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(comp_word, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb10-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kanji_right =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(comp_word, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb10-4"></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(data_jukugo)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 52,791
Columns: 11
$ id                  &lt;int&gt; 173, 234, 432, 461, 481, 529, 937, 1465, 1521, 156…
$ comp_word           &lt;chr&gt; "一部", "一般", "一時", "一番", "一緒", "一致", "…
$ frequency           &lt;int&gt; 46289, 39274, 25126, 24155, 23453, 21388, 12477, 7…
$ grammatical_feature &lt;chr&gt; "possible to use as an adverb", "general noun", "p…
$ pronunciation       &lt;chr&gt; "itibu", "ippan", "itizi", "itiban", "issyo", "itt…
$ english_translation &lt;chr&gt; "one part", "general", "one o'clock", "best", "tog…
$ position            &lt;chr&gt; "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", …
$ kanji               &lt;chr&gt; "一", "一", "一", "一", "一", "一", "一", "一", "…
$ kanji_id            &lt;int&gt; 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41…
$ kanji_left          &lt;chr&gt; "一", "一", "一", "一", "一", "一", "一", "一", "…
$ kanji_right         &lt;chr&gt; "部", "般", "時", "番", "緒", "致", "定", "連", "…</code></pre>
</div>
</div>
<p>Let’s explain the code:</p>
<ul>
<li><code>mutate()</code> is the <code>dplyr</code> function used to create or change variables. Here, I create two variables, <code>kanji_left</code> and <code>kanji_right</code>.</li>
<li><code>substr()</code> is a base function that subtracts a string of text from a character variable. <code>substr(comp_word, 1, 1)</code> means to subtract only the first character, and <code>substr(comp_word, 2, 2)</code> gets the second character.</li>
</ul>
<p>Alright, now I need to define the list of kanjis that I’m currently learning. This I need to do it manually, but later I’ll explain how to do it more dinamically.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">kanji_learning <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"一"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"二"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"三"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"王"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"玉"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"十"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"五"</span>)</span></code></pre></div>
</div>
<p>Lastly, I’ll tell R to filter the jukugos that only include kanji that are on my learning list. I also want to sort the jukugos from more to less used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">jukugo_learning <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_jukugo <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(kanji_left <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> kanji_learning, kanji_right <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> kanji_learning) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(frequency))</span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(jukugo_learning)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id comp_word frequency          grammatical_feature pronunciation
1 17059      二三        32 possible to use as an adverb         nisan
2 17059      二三        32 possible to use as an adverb         nisan
3 20330      三一        12                 general noun        sanpin
4 20330      三一        12                 general noun        sanpin
5 23443      一一         4 possible to use as an adverb        itiiti
6 23443      一一         4 possible to use as an adverb        itiiti
  english_translation position kanji kanji_id kanji_left kanji_right
1        two or three        L    二     1577         二          三
2        two or three        R    三      744         二          三
3 low-ranking samurai        R    一       41         三          一
4 low-ranking samurai        L    三      744         三          一
5          one-by-one        L    一       41         一          一
6          one-by-one        R    一       41         一          一</code></pre>
</div>
</div>
<p>The <code>filter()</code> function selects rows based on one or more conditions. I’ve passed two conditions: that <code>kanji_left</code> is included in the <code>kanji_learning</code> “list” (in R we’d call this a vector, not a list), and that <code>kanji_right</code> is also included in <code>kanji_learning</code>. The term “is included in” is represented in R with the operand <code>%in%</code>.</p>
<p>The <code>arrange()</code> function reorders the rows based on one or more variables. I’ve passed the argument <code>desc(frequency)</code> because I want the words to be sorted in descending order of frequency (from more to less frequency).</p>
<p>However, something odd has happened: now we have two copies of each jukugo. There are complete duplicates in the dataset, with the only difference of which kanji appears in the variables <code>position</code>, <code>kanji</code>, and <code>kanji_id</code>. For example, “nisan” (二三) appears twice, one with <code>position</code> L, <code>kanji</code> 二, and <code>kanji_id</code> 1577, and another with <code>position</code> R, <code>kanji</code> 三, and <code>kanji_id</code> 744. This is something that I didn’t see first time I explored the dataset.</p>
<p>I could have done things differently. Instead of splitting the jukugos manually, I could have performed a “self-join” of the duplicated rows. But one cool thing about data cleaning and analysis is that there are always different ways to reach the same goal. It’s an iterative process, and by trial and error I can learn a lot and find alternative methods of doing things.</p>
<p>Moving forward, since I’m only interested in keeping one record of each jukugo, I can drop these duplicates. Aditionally, I’ll keep only the variables I’m interested in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">jukugo_learning <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> jukugo_learning <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id, comp_word, frequency, grammatical_feature, pronunciation, english_translation, kanji_left, kanji_right) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>()</span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(jukugo_learning)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id comp_word frequency          grammatical_feature pronunciation
1 17059      二三        32 possible to use as an adverb         nisan
2 20330      三一        12                 general noun        sanpin
3 23443      一一         4 possible to use as an adverb        itiiti
4 25773      二王         2                 general noun          nioo
          english_translation kanji_left kanji_right
1                two or three         二          三
2         low-ranking samurai         三          一
3                  one-by-one         一          一
4 the two guardian Deva kings         二          王</code></pre>
</div>
</div>
<p>I’ve used two new <code>dplyr</code> functions: <code>select()</code> keeps some columns or variables, and <code>distinct()</code> keeps only non-duplicated rows.</p>
<p>The final result contains four distinct jukugos: 二三, 三一, 一一, and 二王. All of them are very low-frequency, with the most common of them appearing only 32 times.</p>
</section>
<section id="next-step-making-it-interactive" class="level1">
<h1>Next step: making it interactive</h1>
<p>So far, I have created a code that filters Japanese kanji words based on whatever Kanji components I want. However, the whole process would be nicer if I had a way of selecting the data interactivelly, maybe pressing some buttons. We can do just that using R Shiny applications. Find how in <a href="https://carlosepistats.github.io/blog/posts/kanji_app/post.html">this post</a>!</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><a href="https://www.kanjidatabase.com/index.php">Kanji database</a>.</li>
</ul>


</section>

 ]]></description>
  <category>R</category>
  <category>data cleaning</category>
  <category>exploratory</category>
  <guid>https://CarlosEpiStats.github.io/blog/posts/kanji/post.html</guid>
  <pubDate>Mon, 26 Feb 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>How to Create an Alluvial Plot in R</title>
  <dc:creator>Carlos Fernández</dc:creator>
  <link>https://CarlosEpiStats.github.io/blog/posts/alluvial_plot/post.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this post, I explain how to create an alluvial plot using code in R</p>
<section id="what-is-an-alluvial-diagram" class="level2">
<h2 class="anchored" data-anchor-id="what-is-an-alluvial-diagram">What is an Alluvial Diagram</h2>
<p>An alluvial diagram or plot displays the flow of information from one categorical variable or stage to the next. The term “alluvial” refers to its resemblance to the flow of a river.</p>
</section>
<section id="uses-of-alluvial-diagrams" class="level2">
<h2 class="anchored" data-anchor-id="uses-of-alluvial-diagrams">Uses of Alluvial Diagrams</h2>
<p>Alluvial diagrams are commonly used in the following situations:</p>
<ul>
<li>To demonstrate the number of participants in a study transitioning from one baseline category to a subsequent category. For example, the number of participants randomized at the beginning of the study and who continue to follow-up at the end. It serves as a graphical supplement to flowcharts, which present information with arrows and boxes containing text and numbers.</li>
<li>To show the distribution of participants among different categorical variables. In this case, it provides a more “visually appealing” alternative to stacked column charts.</li>
</ul>
</section>
</section>
<section id="r-code" class="level1">
<h1>R Code</h1>
<section id="preparativos" class="level2">
<h2 class="anchored" data-anchor-id="preparativos">Preparativos</h2>
<p>For this example, we will use the <code>ggalluvial</code> and <code>ggplot2</code> libraries. The data come from a study on language learning using the web application <em>LingQ</em> (<a href="http://comparelanguageapps.com/documentation/LingQ_Efficacy_2023.pdf">Link to the article</a>).</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load necessary libraries</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Includes ggplot2</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggalluvial)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input data</span></span>
<span id="cb1-7"></span>
<span id="cb1-8">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb1-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Initial =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"First"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Second"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Third"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fourth+"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb1-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Final =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"First"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Second"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Third"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fourth+"</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), </span>
<span id="cb1-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Frequency =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-12">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb1-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Initial =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(Initial, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"First"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Second"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Third"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fourth+"</span>)),</span>
<span id="cb1-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Final =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(Final, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"First"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Second"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Third"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fourth+"</span>))</span>
<span id="cb1-16">  )</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(data)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Initial   Final Frequency
1   First   First        28
2   First  Second        28
3   First   Third        10
4   First Fourth+         4
5  Second   First         3
6  Second  Second         6</code></pre>
</div>
</div>
<p>In this study, a total of 192 individuals were selected for the sample and completed the initial knowledge test. Out of these, 101 completed the final test and studied for at least two hours in the application, and were included in the analysis. The data show the equivalent language knowledge in formal education semesters (“First”, “Second”, “Third”, “Fourth or more”) at the beginning of the study (“Initial”) and after using the application (“Final”).</p>
<p><em>Note: The data have been extracted from the example article from the result tables and are just an example of a data distribution compatible with those results.</em></p>
</section>
<section id="alluvial-plot" class="level2">
<h2 class="anchored" data-anchor-id="alluvial-plot">Alluvial Plot</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(Initial), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(Final),</span>
<span id="cb3-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Frequency)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Initial"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Final"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_alluvium</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Final)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_stratum</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stratum"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(stratum))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Equivalent formal education semesters"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/alluvial_plot/post_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the alluvial diagram, the area of the colored zones is proportional to the frequency, so wider “flows” represent more participants.</p>
<p>The graph shows how the majority of the flow occurs from bottom to top; that is, knowledge tends to improve more than deteriorate. For example, more than half of the participants who started from the first semester of knowledge progressed to the second, third, or fourth semester.</p>
<p>It can also be seen that almost all participants who ended with a knowledge level equivalent to the first semester started from that previous level, and a few decreased from the second semester to the first semester.</p>
<p>In conclusion, alluvial diagrams provide a visual option for better understanding data flows between categories.</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><a href="https://corybrunson.github.io/ggalluvial/">ggalluvial package</a></li>
<li><a href="http://comparelanguageapps.com/documentation/LingQ_Efficacy_2023.pdf">Language learning study with LingQ</a></li>
</ul>


</section>

 ]]></description>
  <category>ggplot</category>
  <category>plot</category>
  <category>alluvial</category>
  <category>R</category>
  <guid>https://CarlosEpiStats.github.io/blog/posts/alluvial_plot/post.html</guid>
  <pubDate>Wed, 21 Feb 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Lasso Regression</title>
  <dc:creator>Carlos Fernández</dc:creator>
  <link>https://CarlosEpiStats.github.io/blog/posts/lasso_regression/post.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this post, I explain what Lasso regression is, what it is used for, and how to use it, with code in R.</p>
<section id="what-is-lasso-regression" class="level2">
<h2 class="anchored" data-anchor-id="what-is-lasso-regression">What is Lasso regression?</h2>
<p>Lasso regression is a modified version of linear regression whose objective is to find the simplest model possible. In order to do that, Lasso method penalizes large regression coefficients, leaving smaller coefficients and even removing some variables from the final model (i.e., setting their coefficients to zero).</p>
<p>Lasso is an acronym of <strong>L</strong>east <strong>A</strong>bsolute <strong>S</strong>hrinkage and <strong>S</strong>elector <strong>O</strong>perator.</p>
</section>
<section id="what-is-lasso-regression-used-for" class="level2">
<h2 class="anchored" data-anchor-id="what-is-lasso-regression-used-for">What is Lasso regression used for?</h2>
<p>Lasso regression is used mainly in two applications:</p>
<ul>
<li><strong>Model variable selection</strong>: Lasso can be used as a method to select the most important variables in a regression model. The least important variables will have their coefficients set to zero, effectively being removed from the final model.</li>
<li><strong>Parameter shrinkage</strong>: Lasso’s coefficients are smaller thant those of a simple lineal regression. This helps to avoid overfitting problems.</li>
</ul>
<p>Given their two main functions, Lasso regression is usually employed in the following situations:</p>
<ul>
<li>When we have a <strong>high-dimensionality</strong> dataset, i.e., with a large number of variables.</li>
<li>When we have <strong>multicolineallity</strong> in our model, i.e., several variables are lineally dependent of one another.</li>
<li>When we want to <strong>automatize the model building</strong>, via automatizing the selection of the included variables.</li>
</ul>
</section>
<section id="how-does-lasso-regression-work" class="level2">
<h2 class="anchored" data-anchor-id="how-does-lasso-regression-work">How does Lasso regression work?</h2>
<p>A traditional multivariable lineal regression model finds a set of regression coefficients (<img src="https://latex.codecogs.com/png.latex?%5Cbeta_0,%20%5Cbeta_1,%20%5Cbeta_2...">) that minimizes the residuals’ squared sum (RSS). That is, the distance between the datapoints and the model predictions.</p>
<p>Lasso regression adds another parameter called L1. L1 is defined as the sum of the absolute values of the model coefficients. Lasso method tries to minimize the sum of RSS and L1. As a consequence, Lasso finds a model with smaller regression coefficients. This whole process is known as “L1 regularization”, and it produces a coefficient “shrinkage”.</p>
<p>Every time we run a Lasso regression, whe need to specify the <strong>lambda</strong> parameter (<img src="https://latex.codecogs.com/png.latex?%5Clambda">). Lambda represents the relative importance of the L1 parameter compared to the RSS part of the minimization formula.</p>
<ul>
<li>With <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%200">, there is no coefficient shrinkage, and the Lasso model is effectively equal to a regular linear regression model.</li>
<li>As <img src="https://latex.codecogs.com/png.latex?%5Clambda"> grows, there is more shrinkage, and more variables are removed from the model.</li>
<li>If <img src="https://latex.codecogs.com/png.latex?%5Clambda"> were to be infinite, all coefficients would be removed, and we would end up with an empty model.</li>
</ul>
<section id="lasso-regression-formula" class="level3">
<h3 class="anchored" data-anchor-id="lasso-regression-formula">Lasso regression formula</h3>
<p><img src="https://latex.codecogs.com/png.latex?min(RSS%20+%20%5Clambda%20%5Csum%20%7C%5Cbeta_j%7C)"></p>
<p>Where</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?RSS"> is the residuals’ square sum.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Clambda"> is Lasso’s penalizing factor.</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Csum%20%7C%5Cbeta_j%7C"> is the sum of the absolute values of the regression coefficients.</li>
</ul>
</section>
</section>
</section>
<section id="code-in-r" class="level1">
<h1>Code in R</h1>
<section id="getting-ready" class="level2">
<h2 class="anchored" data-anchor-id="getting-ready">Getting Ready</h2>
<p>In this example, we’ll use the <code>glmnet</code> library and the example dataset in <code>mtcars</code>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("glmnet") # Install the package (only once)</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(glmnet)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(mtcars)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<p>We’ll use <code>mpg</code> (miles per galon) as the outcome variable, and <code>cyl</code> (number of cylinders), <code>hp</code> (horsepower), <code>wt</code> (weight), <code>gear</code> (gear number), and <code>drat</code> (rear axle ratio) as predictive variables.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the outcome variable</span></span>
<span id="cb3-2">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mtcars<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the predictive variables</span></span>
<span id="cb3-5">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.matrix</span>(mtcars[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cyl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drat"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gear"</span>)])</span></code></pre></div>
</details>
</div>
</section>
<section id="choose-a-value-for-lambda" class="level2">
<h2 class="anchored" data-anchor-id="choose-a-value-for-lambda">Choose a Value for Lambda</h2>
<p>We can choose the value of <img src="https://latex.codecogs.com/png.latex?%5Clambda"> that minimizes the mean-squared error (MSE). The <code>cv.glmnet()</code> function performs “<a href="https://www.statology.org/k-fold-cross-validation/">K-fold cross-validation</a>” to identify this <img src="https://latex.codecogs.com/png.latex?%5Clambda"> value.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cross-validation</span></span>
<span id="cb4-2">cv_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cv.glmnet</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Changing the alpha parameter leads to other types of regression</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find the lambda value that minimizes the MSE</span></span>
<span id="cb4-5">best_lambda <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cv_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda.min</span>
<span id="cb4-6">best_lambda</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3803991</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the results in a plot</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(cv_model)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://CarlosEpiStats.github.io/blog/posts/lasso_regression/post_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The value of lambda that minimizes the MSE turns out to be 0.3803991, which in the plot corresponds to the point <img src="https://latex.codecogs.com/png.latex?Log(%5Clambda)"> = -0.9665344.</p>
</section>
<section id="fitting-the-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-the-model">Fitting the Model</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Model coefficients</span></span>
<span id="cb7-2">best_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glmnet</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> best_lambda)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(best_model)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>6 x 1 sparse Matrix of class "dgCMatrix"
                     s0
(Intercept) 35.99744772
cyl         -0.85518839
hp          -0.01598015
wt          -2.88233444
drat         0.27858106
gear         .         </code></pre>
</div>
</div>
<p>We can observe that the coefficient of <code>gear</code> appears as a point, indicating that the Lasso regression has eliminated the coefficient since the variable was not important enough.</p>
</section>
<section id="comparison-with-linear-regression-without-lasso" class="level2">
<h2 class="anchored" data-anchor-id="comparison-with-linear-regression-without-lasso">Comparison with Linear Regression without Lasso</h2>
<p>For comparison, we can see the coefficients that would result from a multiple linear regression model without parameter shrinkage or variable selection.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">linear_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> cyl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> hp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> wt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> drat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gear, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mtcars)</span>
<span id="cb9-2">model_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(best_model), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(linear_model))</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(model_table) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lasso"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear"</span>)</span>
<span id="cb9-4">model_table</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>6 x 2 sparse Matrix of class "dgCMatrix"
                  Lasso      Linear
(Intercept) 35.99744772 33.99417771
cyl         -0.85518839 -0.72169272
hp          -0.01598015 -0.02227636
wt          -2.88233444 -2.92715539
drat         0.27858106  0.73105753
gear         .           0.16750690</code></pre>
</div>
</div>
<p>The coefficients of the Lasso model have been shrunk slightly, especially for the <code>drat</code> variable, and the <code>gear</code> variable has been automatically excluded.</p>
</section>
</section>
<section id="questions-and-curiosities" class="level1">
<h1>Questions and Curiosities</h1>
<p>Some questions arise for further investigation and writing new posts:</p>
<ul>
<li>How to choose the value of lambda?</li>
<li>How does the method of K-fold cross-validation work?</li>
<li>What sets Lasso apart from other similar models like Ridge?</li>
<li>What is the utility of Lasso regression in the field of public health? What databases can be used as an example?</li>
<li>What articles in the public health field are published using this methodology?</li>
</ul>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li><a href="https://www.statology.org/lasso-regression-in-r/">Statology</a></li>
<li><a href="https://www.geeksforgeeks.org/lasso-regression-in-r-programming/">Geeks for Geeks</a></li>
</ul>


</section>

 ]]></description>
  <category>regression</category>
  <category>R</category>
  <category>lasso</category>
  <guid>https://CarlosEpiStats.github.io/blog/posts/lasso_regression/post.html</guid>
  <pubDate>Mon, 05 Feb 2024 23:00:00 GMT</pubDate>
</item>
</channel>
</rss>
